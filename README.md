# Synthetic Image Generator

## Overview: 
This project generates synthetic fluorescent images and their corresponding labeled images to be used for training models. It also implements and tests a Mask R-CNN model using the generated images.

## Project Structure
[matlab](matlab): This folder contains a MATLAB script. This MATLAB script generates synthetic fluorescent images and corresponding labeled instance segmentation images. These images are displayed in a figure within the MATLAB environment and are also saved as PNG files.

[matlab_batch](matlab_batch): The MATLAB scripts in this folder allow for batch generation of images by converting the script in [matlab](matlab) into functions. It also converted the script for generating cell center and cell shape into seperate functions to keep the final script short and concise, allowing for further addition of cell shapes. Run example.m for a preview of images and batch_run.m for batch generation.

[matlab_app](matlab_app): This folder contains MATLAB scripts that generates a GUI for creating synthetic fluorescent images and corresponding labeled imstance segmentation images. Run the image_generator_app.m file to access the GUI. I am using MATLAB online for coding and debugging, and I don't have access to the APP package. 

[Mask_R_CNN](Mask_R_CNN): This folder contains an example implementation and test of a Mask R-CNN model using the fluorescent images and corresponding labeled images generated by the MATLAB script. Open [Mask_RCNN_testing.ipynb](Mask_R_CNN/Mask_RCNN_testing.ipynb) to see the training process and results. The printed loss function values show a decrease after training, indicating that the model is training successfully.

## Assumption for the Image Generator:

**1. Random Elliptical cells**: Each cell has an elliptical shape, generated with random semi-major and semi-minor axes, and a random rotation angel. The “size”, which is the base radius can be adjusted to show larger or smaller cells. 

**2. Homogeneous distribution of Fluorescent**: The fluorescent signal is assumed to be expressed homogeneously throughout the cell. A Gaussian blur is added to mimic a real image, but it is assumed that there is no difference in the fluorescent expression level between the nucleus and cytoplasm.

**3. No Overlap**: Cells are placed in a way that they do not overlap.

**4. Gaussian Blur**: The fluorescent image is blurred with a Gaussian filter to mimic the fluorescent glow effect.

**5. Labeling:** Each ellipse has a unique label in the instance segmentation image.

**6. Gaussian Noises**: Gaussian noise that affects every pixel independently are added to the image to mimic microscope camera noise.

**7. Saving output:** The generated image (fluorescent image in uint16 and labeled image as uint8) are saved as PNG files
